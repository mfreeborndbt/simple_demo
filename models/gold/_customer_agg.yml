models:
  - name: customer_agg
    description: >
      Customer aggregation table providing summary metrics for reporting and analytics.
      Aggregates customer order behavior from the silver layer into customer-level KPIs.
      This model serves as the foundation for customer performance dashboards and analysis.
    columns:
      - name: customer_id
        description: Unique identifier for each customer
        data_tests:
          - not_null
          - unique
      - name: customer_name
        description: Full name of the customer
      - name: customer_type
        description: Classification as 'new' or 'returning' customer
      - name: spend_tier
        description: Customer's spend classification (High Value, Medium Value, Low Value)
      - name: recency_status
        description: Customer's engagement level (Active, At Risk, Inactive)
      - name: total_orders_in_period
        description: Number of orders placed by customer in the analysis period
        data_tests:
          - not_null
      - name: avg_order_value_period
        description: Average order value for customer during the analysis period
      - name: total_spent_period
        description: Total amount spent by customer during the analysis period
      - name: total_profit_generated
        description: Total gross profit generated by this customer
      - name: avg_margin_percent
        description: Average gross margin percentage across customer's orders
      - name: large_orders
        description: Count of large orders placed by this customer
      - name: combo_orders
        description: Count of combo orders (food + drink) placed by this customer
      - name: above_avg_orders
        description: Count of orders that were above this customer's historical average
      - name: lifetime_orders_total
        description: Total number of orders customer has placed across all time
      - name: lifetime_spend_total
        description: Total amount customer has spent across all time (pre-tax)
      - name: customer_tenure_days
        description: Number of days since customer's first order
      - name: first_order_in_period
        description: Date of customer's first order in the analysis period
      - name: last_order_in_period
        description: Date of customer's most recent order in the analysis period
